// @author Roman Torshin, Apache 2.0 licence
(function(globals) {
	'use strict';
	function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(t,e,n){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=_typeof(o))return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _createForOfIteratorHelper(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,r=function t(){};return{s:r,n:function e(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function t(e){throw e},f:r}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function e(){n=n.call(t)},n:function t(){var e=n.next();return a=e.done,e},e:function t(e){c=!0,i=e},f:function t(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=({}).toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=Array(e);n<e;n++)o[n]=t[n];return o}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var _o=function t(e){var n,o={els:[],ie:{}},r="object",i="function",a=document,c=-1,s=0,l=0,u=[],f=0,d=0,p=function t(e){return _typeof(e)},y=function t(e,n){for(var o in e)Object.hasOwnProperty.call(e,o)&&n(o,e)},v=_o.onError||function(){},h=function t(e){return function(){try{var t=e(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3]);return t!==n?t:o}catch(r){v(r)}}},g=function t(e){for(f=s;f<=c;f++)e()},$=function t(e){return p(e)!==r&&(e=_o.first(e).el),e},m=function t(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.els,i=r.length;o.length=i,c=i-1,s=0,o.el=i?r[0]:n,o.last=i?r[c]:n,e&&(y(u,function(t,e){delete o[e[t]]}),u=[],o.ie={})},b=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Array.from(a.querySelectorAll(e))};o.reset=_o;var S=function t(e,o,a){y(o,function(t){var c,s=o[t];p(s)===i&&(s=s(a)),"append"===t&&p(s)===r&&(s.els&&(s=[s]),s[0]&&s[0].els&&(valueBuff=[],y(s,function(t){var e;(e=valueBuff).push.apply(e,_toConsumableArray(s[t].els))}),s=valueBuff)),s!==n&&(["tag","sample","state"].includes(t)||(["html","innerHTML"].includes(t)?e.innerHTML=s:"dataset"===t&&p(s)===r?y(s,function(t){e.dataset[t]=s[t]}):"toggleClass"===t?e.classList.toggle(s):"addClass"===t?p(s)===r?(c=e.classList).add.apply(c,_toConsumableArray(s)):e.classList.add(s):"removeClass"===t?e.classList.remove(s):"style"===t&&p(s)===r?y(s,function(t){e.style[t]=s[t]}):"append"===t&&p(s)===r?y(s.length?s:[s],function(t){e.appendChild(s[t])}):e.setAttribute(t,s)))}),e.dataset.oState=o.state};return o.init=h(function(t){var e=o.initID||_o.inits.length||0;o.initID=e,m(),_o.inits[o.initID]=o,(p(t)!==r||t.render===n)&&(t={render:t}),y(t,function(l){u.push(l),o[l]=h(function(){var u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[{}],y=t[l]||{tag:"div"},v=o.els.slice(s,c+1);p(y)===r&&(y.state=l,y["data-o-init"]=e);var h=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p(y)===r?a.createElement(y.tag||"div"):((f=a.createElement("div")).innerHTML=p(y)===i?y(n):y,f.children.length>1||!f.firstElementChild)?(f.dataset.oInit=e,f):(f.firstElementChild.dataset.oInit=e,f.firstElementChild)};u.length||(u=[u]);var g=!v[0]&&"render"===l;u=u.map(function(t,r){return t.self=o,t.o=_o,t.i=t.i===n?r:t.i,g&&v.push(h(e,t)),t}),g&&(o.els=v,m(!1)),v&&(d=v.length===u.length,v.map(function(t,e){u[d?e:0].i=e+s;var n=p(y)===i?y(u[d?e:0]):y;p(n)===r&&S(t,n,u[d?e:0])}))})})}),o.initState=h(function(t,e){o.init(t).render(e)}),o.sample=h(function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"render",n=o.els[s].attributes,r=o.els[s].dataset,i={tag:o.els[s].tagName,html:o.els[s].innerHTML,dataset:{}},a=_createForOfIteratorHelper(n);try{for(a.s();!(t=a.n()).done;){var c=t.value;"data-"!==c.nodeName.substring(0,5)&&(i[c.nodeName]=c.value)}}catch(l){a.e(l)}finally{a.f()}return y(r,function(t){i.dataset[t]=r[t]}),_defineProperty({},e,i)}),o.select=h(function(t){t===n&&(t=o.length-1),c=t,s=t,o.el=o.els[t],l=1}),o.all=h(function(){c=o.length-1,s=0,o.el=o.els[0],l=0}),o.remove=h(function(t){t===n&&l&&(t=s),t!==n?o.els[t].parentNode.removeChild(o.els[t]):g(function(){o.els[f].parentNode.removeChild(o.els[f])}),m(!1)}),o.skip=h(function(t){t===n&&(t=s),o.els.splice(f,1),m()}),o.add=h(function(t,e){var i,a,c;"string"===p(t)&&""!==t?(i=o.els).push.apply(i,_toConsumableArray(b(t))):p(t)===r?t.tagName?o.els.push(t):t.els?(a=o.els).push.apply(a,_toConsumableArray(t.els)):t.length&&t[0].tagName&&(c=o.els).push.apply(c,_toConsumableArray(t)):"number"===p(t)&&_o.inits[t]&&(o=_o.inits[t]),m(!1),o.initID!==n&&o.dataset({oInit:o.initID})}),o.appendInside=h(function(t){g(function(){$(t).appendChild(o.els[f])})}),o.appendBefore=h(function(t){g(function(){$(t).parentNode.insertBefore(o.els[f],$(t))})}),o.appendAfter=h(function(t){g(function(){var e;(e=$(t)).after.apply(e,_toConsumableArray(o.els))})}),o.find=h(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=[];return g(function(){e.push.apply(e,_toConsumableArray(Array.from(o.els[f].querySelectorAll(":scope "+t))))}),_o(e)}),o.first=h(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=n,r=[];return g(function(){(e=o.els[f].querySelector(t))&&r.push(e)}),_o(r)}),o.attr=h(function(t,e){if(t){if(e===n){var r=[];return g(function(){r[f]=o.els[f].getAttribute(t)}),l?r[0]:r}""!==e?g(function(){o.els[f].setAttribute(t,e)}):g(function(){o.els[f].removeAttribute(t)})}}),o.attrs=h(function(){var t=[];return g(function(){var e={};_toConsumableArray(o.els[f].attributes).forEach(function(t){e[t.nodeName]=t.nodeValue}),t.push(e)}),l?t[0]:t}),o.dataset=h(function(t){if(_typeof(t)===r)g(function(){y(t,function(e){o.els[f].dataset[e]=t[e]})});else{var e=[];return g(function(){e.push(_objectSpread({},o.els[f].dataset))}),l?e[0]:e}}),o.style=h(function(t){o.attr("style",t)}),o.css=h(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e="";y(t,function(n){e+=n+":"+t[n].replace('"',"'")+";"}),o.style(e)}),o.setClass=h(function(t){g(function(){o.els[f].setAttribute("class",t)})}),o.addClass=h(function(t){g(function(){o.els[f].classList.add(t)})}),o.removeClass=h(function(t){g(function(){o.els[f].classList.remove(t)})}),o.toggleClass=h(function(t,e){g(function(){o.els[f].classList.toggle(t,e)})}),o.haveClass=function(t){var e=!0;return g(function(){o.els[f].classList.contains(t)||(e=!1)}),e},o.innerHTML=h(function(t){if(t!==n)g(function(){o.els[f].innerHTML=t});else{var e="";return g(function(){e+=o.els[f].innerHTML}),e}}),o.innerText=h(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";g(function(){o.els[f].innerText=t})}),o.textContent=h(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";g(function(){o.els[f].textContent=t})}),o.html=h(function(t){if(t)o.innerHTML(t);else{var e="";return g(function(){e+=o.els[f].outerHTML}),e}}),o.forEach=h(function(t){g(function(){t({self:_o(o.els[f]).select(),i:f})})}),o.on=h(function(t,e,n,r){t.split(", ").forEach(function(t){g(function(){o.els[f].addEventListener(t,e,n,r)}),o.ie[t]||(o.ie[t]=[]),o.ie[t].push([e,n,r])})}),o.off=h(function(t,e,n){t.split(", ").forEach(function(t){g(function(){o.els[f].removeEventListener(t,e,n)}),o.ie[t]&&(o.ie[t]=o.ie[t].filter(function(t){return t[0]!==e}))})}),o.onAll=h(function(t,e){y(o.ie,function(n,r){t&&t!==n||r[n].forEach(function(t){g(function(){e?o.els[f].removeEventListener(n,t[0]):o.els[f].addEventListener(n,t[0],t[1],t[2])})})})}),o.offAll=h(function(t){o.onAll(t,1)}),e&&o.add(e),o.take=function(t){if(o.add(t),o.el){var e=o.el.dataset.oInit;if(e!==n&&_o.inits[e])return 1===o.length?(d=o.els[0],Object.assign(o,_o.inits[e]),o.els=[d]):o=_o.inits[e],m(!1,o.els),o}},o};_o.first=function(t){return _o(document.querySelector(t)||"")},_o.inits=[],_o.errors=[],_o.showErrors=!1,_o.logErrors=function(){_o.errors.length?_o.errors.forEach(function(t){return console.log(t)}):console.log("No errors")},_o.onError=function(t){_o.showErrors?console.log(t):_o.errors.push(t)},_o.init=function(t){return _o().init(t)},_o.initState=function(t,e){return _o().init(t).render(e)},_o.take=function(t){return _o().take(t)},_o.Z=0,_o.N=1,_o.W=2,_o.H=100,_o.F=!1,_o.C=function(t,e){return Object.hasOwnProperty.call(t,e)},_o.ajax=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new URLSearchParams;if(e.data&&"object"==_typeof(e.data)){for(var o in e.data)_o.C(e.data,o)&&("object"==_typeof(e.data[o])?n.set(o,encodeURIComponent(JSON.stringify(e.data[o]))):n.set(o,e.data[o]));"get"===e.method.toLowerCase()?t+="?"+n.toString():e.body||(e.body=n),delete e.data}return e.headers||(e.headers={"X-Requested-With":"XMLHttpRequest"}),fetch(t,e)},_o.get=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _o.ajax(t,_objectSpread(_objectSpread({},e),{},{method:"GET"}))},_o.post=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _o.ajax(t,_objectSpread(_objectSpread({},e),{},{method:"POST"}))},_o.getParams=function(t){var e,n={},o=new URLSearchParams(window.location.search).entries(),r=_createForOfIteratorHelper(o);try{for(r.s();!(e=r.n()).done;){var i=e.value;n[i[_o.Z]]=i[_o.N]}}catch(a){r.e(a)}finally{r.f()}return t?n[t]:n},_o.incCache=!0,_o.incCacheExp=864e5,_o.incTimeout=6e3,_o.incSource="",_o.incForce=_o.F,_o.incAsync=!0,_o.incCors=_o.F,_o.incFns={},_o.incSet=[_o.Z],_o.incReady=[_o.Z],_o.incN=_o.Z,_o.incCheck=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return!n&&t&&e===_o.U&&_o.incReady[t]?_o.incSet[t]===_o.N:_o.incReady[t]===_o.U||_o.incReady[t][e]===_o.U?_o.F:(_o.incReady[t][e].loaded=n,_o.incFns[_o.incReady[t][e].name]=n,_o.incReady[t][_o.Z]+=n,t&&_o.incReady[t].length===_o.incReady[t][_o.Z]&&("function"==typeof _o.incSet[t]&&_o.incSet[t](t),_o.incSet[t]=_o.N),_o.incSet[t]===_o.N)},_o.incCacheClear=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_o.F;for(var e in _o.incFns)_o.C(_o.incFns,e)&&(localStorage.removeItem("inc-"+e),localStorage.removeItem("inc-"+e+"Expires"));return t&&(_o.incReady.forEach(function(t,e){e&&t.forEach(function(t,n){n&&_o("#oInc-"+e+"-"+n).remove()})}),_o.incN=_o.Z,_o.incFns={},_o.incSet=[_o.Z],_o.incReady=[_o.Z]),!0},_o.inc=function(t,e,n){var o=_o.Z,r=_o.Z,i="function";if("object"!=_typeof(t)||!t)return _o.incSet[_o.Z];_o.incSet[_o.Z]++;var a=_o.incSet[_o.Z];_o.incSet[a]=e||_o.Z,_o.incReady[a]=[];var c=_o.incReady[a];c[_o.Z]=_o.N;var s={},l=function e(n){if(_o.C(t,n)){o++,_o.incN++;var i=t[n].indexOf(".css")>-1?"style":"script";if(t[n]=(_o.incSource?_o.incSource+"/":"")+t[n],isNaN(n)&&_o.C(_o.incFns,n)&&_o.incFns[n]&&!_o.incForce)return c[o]={name:n,loaded:_o.N},r++,1;if(c[o]={name:n,loaded:_o.Z},isNaN(n)&&(_o.incFns[n]=_o.Z),isNaN(n)&&_o.incCache&&"http"!==t[n].substring(_o.Z,4)&&"file:"!==window.location.protocol&&(t[n].indexOf(".css")>-1||t[n].indexOf(".js")>-1)){var l=localStorage,u=l.getItem("inc-"+n),f=l.getItem("inc-"+n+"Expires");u&&f&&new Date().getTime()<f?(_o.initState({tag:i,id:"oInc-"+a+"-"+o,innerHTML:u,"data-o-inc":a}).appendInside("head"),c[o].loaded=_o.N,_o.incFns[n]=_o.N,r++):(s[n]=o,_o.get(t[n],{mode:_o.incCors?"cors":"same-origin"}).then(function(e){if(200!==e.status){_o.onError&&_o.onError({message:_o.incSource+t[n]+" was not loaded"});return}e.text().then(function(t){l.setItem("inc-"+n,t),l.setItem("inc-"+n+"Expires",new Date().getTime()+_o.incCacheExp),_o.initState({tag:i,id:"oInc-"+a+"-"+s[n],innerHTML:t,"data-o-inc":a}).appendInside("head"),_o.incCheck(a,s[n],_o.N)})}))}else{var d={tag:i,id:"oInc-"+a+"-"+o,"data-o-inc":a,async:_o.incAsync,onload:"o.incCheck("+a+","+o+",1)"};t[n].indexOf(".css")>-1?(d.tag="link",d.rel="stylesheet",d.href=t[n]):(t[n].indexOf(".js")>-1||(d.tag="img",d.style="display:none;"),d.src=t[n]),_o.initState(d).appendInside(d.style?"body":"head")}}};for(var u in t)if(l(u))continue;return c[_o.Z]+=r,o!==_o.Z&&(r===o?_typeof(e)===i&&e(a):setTimeout(function(t){_o.incReady[t]&&_o.incReady[t].length<_o.incReady[t][_o.Z]&&(_o.incSet[t]=_o.Z,_typeof(n)===i&&n(a))},_o.incTimeout,a)),_o.incSet[_o.Z]},_o.tLog=[],_o.tRes=[],_o.tStatus=[],_o.tFns=[],_o.tShowOk=_o.F,_o.tStyled=_o.F,_o.tTime=2e3,_o.tPre='<div style="font-family:monospace;text-align:left;">',_o.tOk='<span style="background:#cfc;padding: 0 15px;">OK</span> ',_o.tXx='<div style="background:#fcc;padding:3px;">',_o.tDc="</div>",_o.test=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length,n=Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];var r=_o.tLog.length,i=0,a="├ OK: ",c="├ ✘ ",s="\n",l="\n",u=n.length,f=_o.Z;"function"==typeof n[u-_o.N]&&(_o.tFns[r]=n[u-_o.N],u--),_o.tStyled?(_o.tLog[r]="<div><b>"+t+" #"+r+"</b></div>",a=_o.tPre+_o.tOk,c=_o.tPre+_o.tXx,l=(s=_o.tDc)+s):_o.tLog[r]=t+" #"+r+"\n",_o.tRes[r]=_o.F,_o.tStatus[r]=[];for(var d=_o.Z;d<u;d++){var p={n:r,i:d,title:n[d][_o.Z],tShowOk:_o.tShowOk,tStyled:_o.tStyled},y=n[d][_o.N];if("function"==typeof y)try{y=y(p)}catch(v){y=v.message,_o.onError&&_o.onError(v)}_o.tStatus[r][d]="string"==typeof y?_o.F:y,!0===y?(f++,_o.tShowOk&&(_o.tLog[r]+=a+n[d][_o.Z]+s)):y!==_o.U?_o.tLog[r]+=c+n[d][_o.Z]+(y!==_o.F?": <i>"+y+"</i>":"")+l:(i++,setTimeout(function(t){t.title+=" (timeout)",_o.testUpdate(t)},_o.tTime,p))}return _o.tRes[r]=f===u,_o.tStyled?_o.tLog[r]+=_o.tPre+'<div style="color:'+(f+i!==u?"red":"green")+';"><b>':_o.tLog[r]+=i?"├":"└ ",_o.tLog[r]+="DONE "+f+"/"+(u-i),i&&(_o.tLog[r]+=", waiting: "+i),_o.tStyled?_o.tLog[r]+="</b>"+_o.tDc+_o.tDc:_o.tLog[r]+="\n",i||"function"!=typeof _o.tFns[r]||_o.tFns[r](r),r},_o.testUpdate=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_o.F,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(_o.tStatus[t.n][t.i]===_o.U){_o.tStatus[t.n][t.i]=!0===e,!0===e?t.tShowOk&&(t.tStyled?_o.tLog[t.n]+=_o.tPre+_o.tOk+t.title+n+_o.tDc:_o.tLog[t.n]+="└ OK: "+t.title+n+"\n"):(_o.tRes[t.n]=_o.F,t.tStyled?_o.tLog[t.n]+=_o.tPre+_o.tXx+t.title+n+(e?": "+e:"")+_o.tDc+_o.tDc:_o.tLog[t.n]+="└ ✘ "+t.title+(e?": "+e:"")+n+"\n");var o,r=_o.Z,i=r,a=_createForOfIteratorHelper(_o.tStatus[t.n]);try{for(a.s();!(o=a.n()).done;){var c=o.value;if(c===_o.U)return;!c&&r++,i++}}catch(s){a.e(s)}finally{a.f()}_o.tRes[t.n]=!r;var l=r?"FAILED "+r+"/"+i:"DONE "+i+"/"+i;t.tStyled?_o.tLog[t.n]+=_o.tPre+'<b style="color:'+(r?"red":"green")+';">'+l+"</b>"+_o.tDc:_o.tLog[t.n]+="└ "+l,"function"==typeof _o.tFns[t.n]&&_o.tFns[t.n](t.n)}};

	if (typeof module !== 'undefined' && module.exports) {
		o.default = o;
		module.exports = o;
	} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {
		define('o', [], function () {
			return o;
		});
	} else {
		window.o = o;
	}
})(this);
